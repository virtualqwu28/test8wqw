name: CI

on:
  workflow_dispatch:

jobs:
  sdx-session:
    runs-on: ubuntu-latest
    timeout-minutes: 360  # Giá»¯ session sá»‘ng tá»‘i Ä‘a 6 tiáº¿ng
    steps:
      - name: ğŸ”§ CÃ i Ä‘áº·t Tailscale
        run: |
          curl -fsSL https://tailscale.com/install.sh | sh

      - name: ğŸ” ÄÄƒng nháº­p Tailscale báº±ng Auth Key (cÃ³ SSH)
        run: |
          sudo tailscale up \
            --authkey="${{ secrets.TAILSCALE_TOKEN }}" \
            --ssh \
            --accept-dns=false

      - name: ğŸŒ Hiá»ƒn thá»‹ Ä‘á»‹a chá»‰ IP Tailscale
        run: |
          echo "ğŸ”— Tailscale IP: $(tailscale ip -4)"
          echo "âœ… SSH vÃ o báº±ng: ssh ubuntu@$(tailscale ip -4)"

      - name: ğŸ’¤ Giá»¯ session sá»‘ng (tá»‘i Ä‘a 6 tiáº¿ng)
        run: |
          echo "âŒ› Session sáº½ giá»¯ trong 6 tiáº¿ng. Dá»«ng láº¡i báº±ng Cancel Workflow."
          sleep 21600  # 6 tiáº¿ng (6 * 60 * 60)
